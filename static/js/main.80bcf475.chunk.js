(this["webpackJsonpVoip-react"]=this["webpackJsonpVoip-react"]||[]).push([[1],{137:function(e,n,t){var r={"./ion-action-sheet.entry.js":[161,5],"./ion-alert.entry.js":[162,6],"./ion-app_8.entry.js":[163,7],"./ion-avatar_3.entry.js":[164,17],"./ion-back-button.entry.js":[165,18],"./ion-backdrop.entry.js":[166,43],"./ion-button_2.entry.js":[167,19],"./ion-card_5.entry.js":[168,20],"./ion-checkbox.entry.js":[169,21],"./ion-chip.entry.js":[170,22],"./ion-col_3.entry.js":[171,44],"./ion-datetime_3.entry.js":[172,10],"./ion-fab_3.entry.js":[173,23],"./ion-img.entry.js":[174,45],"./ion-infinite-scroll_2.entry.js":[175,46],"./ion-input.entry.js":[176,24],"./ion-item-option_3.entry.js":[177,25],"./ion-item_8.entry.js":[178,26],"./ion-loading.entry.js":[179,27],"./ion-menu_3.entry.js":[180,28],"./ion-modal.entry.js":[181,8],"./ion-nav_2.entry.js":[182,14],"./ion-popover.entry.js":[183,9],"./ion-progress-bar.entry.js":[184,29],"./ion-radio_2.entry.js":[185,30],"./ion-range.entry.js":[186,31],"./ion-refresher_2.entry.js":[187,11],"./ion-reorder_2.entry.js":[188,16],"./ion-ripple-effect.entry.js":[189,47],"./ion-route_4.entry.js":[190,32],"./ion-searchbar.entry.js":[191,33],"./ion-segment_2.entry.js":[192,34],"./ion-select_3.entry.js":[193,35],"./ion-slide_2.entry.js":[194,48],"./ion-spinner.entry.js":[195,13],"./ion-split-pane.entry.js":[196,49],"./ion-tab-bar_2.entry.js":[197,36],"./ion-tab_2.entry.js":[198,15],"./ion-text.entry.js":[199,37],"./ion-textarea.entry.js":[200,38],"./ion-toast.entry.js":[201,39],"./ion-toggle.entry.js":[202,12],"./ion-virtual-scroll.entry.js":[203,50]};function c(e){if(!t.o(r,e))return Promise.resolve().then((function(){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}));var n=r[e],c=n[0];return t.e(n[1]).then((function(){return t(c)}))}c.keys=function(){return Object.keys(r)},c.id=137,e.exports=c},139:function(e,n,t){var r={"./ion-icon.entry.js":[204,57]};function c(e){if(!t.o(r,e))return Promise.resolve().then((function(){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}));var n=r[e],c=n[0];return t.e(n[1]).then((function(){return t(c)}))}c.keys=function(){return Object.keys(r)},c.id=139,e.exports=c},150:function(e,n,t){},155:function(e,n,t){},156:function(e,n,t){},157:function(e,n,t){},158:function(e,n,t){"use strict";t.r(n);var r=t(0),c=t.n(r),a=t(47),o=t.n(a),s=t(30),i=t(69),l=t(106),j=t(14),d="[Auth] Login",u="[UI] Set Error",b="[UI] Remove Error",O="[UI] Start Loading",h="[UI] Finish Loading",p="[UI] Start Call Alert",m="[UI] Finish Call Alert",f="[SIP] Receive UA",x="[SIP] Start Calling",g="[SIP] Set Extension To Call",y="[SIP] Set Outgoingcall",v="[SIP] Incoming Call",k="[SIP] Start Communication",w="[SIP] Clear Incoming Session",S={registerState:null,user:null},N={userAgent:{},extensionToCall:null,sessionState:null,outgoingSession:null,incomingSession:null,startCall:""},I={loading:!1,msgError:null,showAlert:!1},C=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||i.c,E=Object(i.b)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case d:return Object(j.a)(Object(j.a)({},e),{},{user:n.payload.user,registerState:n.payload.registerState});default:return e}},ui:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case u:return Object(j.a)(Object(j.a)({},e),{},{msgError:n.payload});case b:return Object(j.a)(Object(j.a)({},e),{},{msgError:null});case O:return Object(j.a)(Object(j.a)({},e),{},{loading:!0});case h:return Object(j.a)(Object(j.a)({},e),{},{loading:!1});case p:return Object(j.a)(Object(j.a)({},e),{},{showAlert:!0});case m:return Object(j.a)(Object(j.a)({},e),{},{showAlert:!1});default:return e}},sip:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case f:return Object(j.a)(Object(j.a)({},e),{},{userAgent:n.payload});case x:return Object(j.a)(Object(j.a)({},e),{},{sessionState:n.payload});case g:return Object(j.a)(Object(j.a)({},e),{},{extensionToCall:n.payload});case y:return Object(j.a)(Object(j.a)({},e),{},{outgoingSession:n.payload});case k:return Object(j.a)(Object(j.a)({},e),{},{startCall:n.payload});case v:return Object(j.a)(Object(j.a)({},e),{},{incomingSession:n.payload});case w:return Object(j.a)(Object(j.a)({},e),{},{incomingSession:null});default:return e}}}),_=Object(i.d)(E,C(Object(i.a)(l.a))),U=t(4),z=(t(140),t(141),t(142),t(143),t(144),t(145),t(146),t(147),t(148),t(149),t(150),t(23)),D=t(107),A=t(26),P=function(){return{type:h}},R=function(e){return{type:u,payload:e}},F=t(83),T=t(2),L=function(e){var n=e.isLogged,t=e.component,r=Object(F.a)(e,["isLogged","component"]);return Object(T.jsx)(A.b,Object(j.a)(Object(j.a)({},r),{},{component:function(e){return n?Object(T.jsx)(A.a,{to:"/"}):Object(T.jsx)(t,Object(j.a)({},e))}}))},M=function(e){var n=e.isLogged,t=e.component,r=Object(F.a)(e,["isLogged","component"]);return Object(T.jsx)(A.b,Object(j.a)(Object(j.a)({},r),{},{component:function(e){return n?Object(T.jsx)(t,Object(j.a)({},e)):Object(T.jsx)(A.a,{to:"/auth/login"})}}))},q=t(16),V=t(93),B=t(10),H=t.n(B),X=t(20),J=t(212),G=t(109),K=t(7),W=t(90),Q="voipserverenzo.ddns.net:8088",Y=document.querySelector("#remoteAudio"),Z=(document.querySelector("#localAudio"),function(e){return{type:y,payload:e}}),$=function(e){return{type:g,payload:e}},ee=function(){return{type:w}},ne=function(e){return function(n){n(re(e,Y)),n(te(e))}},te=function(e){return{type:v,payload:e}},re=function(e,n){return function(t){var r={requestOptions:{body:{contentDisposition:"render",contentType:"application/dtmf-relay",content:"Signal=1\r\nDuration=1000"}}};e.stateChange.addListener((function(c){switch(console.error(c),c){case K.a.Initial:e.info(r);break;case K.a.Establishing:t(ce(K.a.Establishing));break;case K.a.Established:t(ce(K.a.Established));var a=e.sessionDescriptionHandler;if(!a||!(a instanceof W.a.SessionDescriptionHandler))throw new Error("Invalid session description handler.");return n&&function(e,n){n.autoplay=!0,n.srcObject=e;var t=n.play();void 0!==t&&t.then((function(){console.error("Good!")})).catch((function(e){console.error("Failed to play media"),console.error(e)})),e.onaddtrack=function(){n.load(),n.play().catch((function(e){console.error("Failed to play remote media on add track"),console.error(e)}))},e.onremovetrack=function(){n.load(),n.play().catch((function(e){console.error("Failed to play remote media on remove track"),console.error(e)}))}}(a.remoteMediaStream,n),K.a.Established;case K.a.Terminating:break;case K.a.Terminated:t(ce(K.a.Terminated)),t(ee());break;default:throw new Error("Unknown session state.")}}))}},ce=function(e){return{type:x,payload:e}},ae=function(e){return function(n,t){"Establishing"===t().sip.sessionState?e.cancel():e.bye(),n(ee())}},oe=function(e){var n=e.setInputValue,t=e.handleCall,r=e.handleBackspace,c=[[1,2,3],[4,5,6],[7,8,9]];return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)("div",{className:"keypad-row",children:c[0].map((function(e){return Object(T.jsx)(U.c,{expand:"full",onClick:function(){return n((function(n){return n+e.toString()}))},className:"keypad-button",children:e},e)}))}),Object(T.jsx)("div",{className:"keypad-row",children:c[1].map((function(e){return Object(T.jsx)(U.c,{expand:"full",onClick:function(){return n((function(n){return n+e.toString()}))},className:"keypad-button",children:e},e)}))}),Object(T.jsx)("div",{className:"keypad-row",children:c[2].map((function(e){return Object(T.jsx)(U.c,{expand:"full",onClick:function(){return n((function(n){return n+e.toString()}))},className:"keypad-button",children:e},e)}))}),Object(T.jsxs)("div",{className:"keypad-row",children:[Object(T.jsx)("div",{className:"keypad-button-call-container",children:Object(T.jsx)(U.c,{shape:"round",expand:"block",color:"secondary",size:"small",className:"keypad-button keypad-button-call-color ",onClick:t,children:Object(T.jsx)(U.k,{size:"extralarge",icon:q.e})})}),Object(T.jsx)(U.c,{expand:"full",onClick:function(){return n((function(e){return e+"0"}))},className:"keypad-button",children:"0"}),Object(T.jsx)(U.c,{onClick:r,className:"keypad-button",children:Object(T.jsx)(U.k,{color:"secondary",icon:q.d})})]})]})},se=function(e){var n,t=e.incomingSession,r=Object(s.b)(),c=Object(s.c)((function(e){return e.sip})),a=c.sessionState,o=c.extensionToCall,i=c.outgoingSession;return Object(T.jsxs)(U.f,{className:"modal-content",fullscreen:!0,children:[Object(T.jsx)(U.y,{className:"modal-call-header-title",size:"large",children:o||(null===t||void 0===t||null===(n=t.assertedIdentity)||void 0===n?void 0:n.displayName)}),Object(T.jsxs)("div",{className:"modal-call-title",children:[Object(T.jsx)(U.x,{children:a}),"Establishing"===a&&Object(T.jsx)(U.w,{className:"modal-call-tittle-spinner",name:"dots"})]}),Object(T.jsxs)(U.i,{children:[Object(T.jsxs)(U.v,{className:"modal-row",children:[Object(T.jsx)(U.e,{children:Object(T.jsxs)(U.g,{horizontal:"center",children:[Object(T.jsx)(U.h,{color:"primary",className:"modal-fab-button",children:Object(T.jsx)(U.k,{size:"large",icon:q.v})}),Object(T.jsx)(U.n,{className:"ion-margin-vertical  ion-padding-vertical",children:"Speaker"})]})}),Object(T.jsx)(U.e,{children:Object(T.jsxs)(U.g,{horizontal:"center",children:[Object(T.jsx)(U.h,{color:"primary",className:"modal-fab-button",children:Object(T.jsx)(U.k,{size:"large",icon:q.p})}),Object(T.jsx)(U.n,{className:"ion-margin-vertical  ion-padding-start ion-padding-vertical",children:"Mute"})]})}),Object(T.jsx)(U.e,{children:Object(T.jsxs)(U.g,{horizontal:"center",children:[Object(T.jsx)(U.h,{color:"primary",className:"modal-fab-button",children:Object(T.jsx)(U.k,{size:"large",icon:q.m})}),Object(T.jsx)(U.n,{className:"ion-margin-vertical  ion-padding-start ion-padding-vertical",children:"Keypad"})]})})]}),Object(T.jsx)(U.v,{className:"modal-row",children:Object(T.jsx)(U.e,{children:Object(T.jsx)(U.g,{horizontal:"center",color:"danger",children:Object(T.jsx)(U.h,{onClick:function(){r(ae(i&&null===t?i:t))},className:"modal-fab-button",color:"danger",children:Object(T.jsx)(U.k,{className:"icon-transform",icon:q.e})})})})})]})]})},ie=function(){return Object(T.jsx)(U.f,{children:Object(T.jsxs)(U.o,{children:[Object(T.jsx)(U.p,{className:"ion-padding-end",children:Object(T.jsx)(U.n,{children:"Call Registers"})}),[{type:"answered",number:103,duration:10},{type:"not answered",number:104,duration:0},{type:"answered",number:104,duration:0},{type:"answered",number:103,duration:0},{type:"answered",number:104,duration:0},{type:"answered",number:105,duration:0}].map((function(e,n){return Object(T.jsx)(U.m,{children:Object(T.jsxs)(U.n,{children:[Object(T.jsx)(U.x,{className:"ion-padding-horizontal",children:e.number}),Object(T.jsxs)(U.v,{className:"ion-align-items-center ion-justify-content-between",children:[Object(T.jsx)(U.k,{className:"ion-padding-horizontal",icon:q.b}),Object(T.jsx)("h2",{color:"primary-shade",children:e.type}),Object(T.jsx)("h3",{children:"12:45 Am"}),Object(T.jsx)(U.c,{className:"",shape:"round",color:"secondary",children:Object(T.jsx)(U.k,{icon:q.e})})]})]})},n)}))]})})},le=(t(155),function(){var e,n=Object(r.useState)(""),t=Object(z.a)(n,2),c=t[0],a=t[1],o=Object(r.useState)(!1),i=Object(z.a)(o,2),l=i[0],j=i[1],d=Object(s.c)((function(e){return e.ui})),u=(d.msgError,d.showAlert,Object(s.c)((function(e){return e.auth})).user),b=Object(s.c)((function(e){return e.sip})),O=b.incomingSession,h=b.sessionState,p=Object(s.b)(),m={text:"Reject Call",role:"reject",handler:function(){return p((e=O,function(n){e.reject(),n(ee())}));var e}},f={text:"Accept",handler:function(){return p((e=O,function(n,t){var r=e;console.error(r),r.delegate={onRefer:function(e){}};var c={sessionDescriptionHandlerOptions:{constraints:{audio:!0,video:!1}}};r.accept(c)}));var e}};return O?V.a.vibrate(1e3):V.a.vibrate(0),Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)(U.a,{isOpen:null!==O,header:"Incoming Call",subHeader:O&&"From internal ".concat(null===(e=O.assertedIdentity)||void 0===e?void 0:e.displayName),cssClass:"home-call-alert",buttons:[m,f]}),Object(T.jsx)(U.r,{cssClass:"modal-background",onDidDismiss:function(){return p(ee())},isOpen:"Establishing"===h||"Established"===h,children:Object(T.jsx)(se,{incomingSession:O})}),Object(T.jsxs)(U.t,{children:[Object(T.jsx)(U.j,{children:Object(T.jsx)(U.A,{children:Object(T.jsxs)(U.y,{size:"small",slot:"start",children:["Registrado: ",u]})})}),Object(T.jsxs)(U.f,{className:"ion-justify-content-center",color:"primary",children:[Object(T.jsx)(ie,{}),Object(T.jsx)(U.g,{hidden:l,className:"ion-padding-vertical",vertical:"bottom",horizontal:"end",children:Object(T.jsx)(U.h,{onClick:function(){return j(!0)},color:"secondary",children:Object(T.jsx)(U.k,{icon:q.m})})}),Object(T.jsxs)("div",{hidden:!l,className:"home-complete-keypad",children:[Object(T.jsxs)(U.m,{style:{margin:0},color:"secondary",children:[Object(T.jsx)(U.k,{className:"home-forward-icon",onClick:function(){return j(!1)},icon:q.i}),Object(T.jsx)(U.l,{className:"home-input-keypad",value:c,onIonChange:function(e){e.preventDefault(),a(e.target.value)},clearInput:!0,readonly:!0,type:"number",color:"primary",placeholder:"Ingrese numero de telefono"})]}),Object(T.jsx)(oe,{handleBackspace:function(){a((function(e){return e.substring(0,e.length-1)}))},handleCall:function(){var e;p(c?(e=c,function(){var n=Object(X.a)(H.a.mark((function n(t,r){var c,a,o,s,i;return H.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t($(e)),c=r().sip.userAgent,a=r().auth.user,o=J.a.makeURI("sip:".concat(e,"@").concat(Q))){n.next=6;break}throw new Error("Failed to create target URI.");case 6:s=new G.a(c,o),i=s,t(re(s,Y)),"".concat(a,"@").concat(Q),"sip:".concat(a,"@").concat(Q),i.delegate={onRefer:function(e){}},s.invite().then((function(){t(Z(i))})).catch((function(e){}));case 12:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()):R("Please enter a number to call"))},setInputValue:a})]})]})]})]})}),je=t(211),de=t(18),ue=function(e,n){return{type:d,payload:{user:e,registerState:n}}},be=function(e){return{type:f,payload:e}},Oe=t(25),he=function(e){var n=Object(r.useState)(e),t=Object(z.a)(n,2),c=t[0],a=t[1];return[c,function(e){var n=e.target;a(Object(j.a)(Object(j.a)({},c),{},Object(Oe.a)({},n.name,n.value)))},function(){a(e)}]},pe=function(e){var n=e.setShowModal,t=function(e){var n=e.target;n.name,n.value};return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)(U.j,{translucent:!0,children:Object(T.jsxs)(U.A,{children:[Object(T.jsx)(U.d,{slot:"start",children:Object(T.jsx)(U.c,{onClick:function(){return n(!1)},children:Object(T.jsx)(U.k,{icon:q.a})})}),Object(T.jsx)(U.y,{children:"SIP Settings"})]})}),Object(T.jsx)(U.f,{children:Object(T.jsxs)(U.o,{children:[Object(T.jsxs)(U.m,{children:[Object(T.jsx)(U.n,{position:"floating",children:"SIP URI"}),Object(T.jsx)(U.l,{name:"uri",onIonChange:t})]}),Object(T.jsxs)(U.m,{children:[Object(T.jsx)(U.n,{position:"floating",children:"SIP password"}),Object(T.jsx)(U.l,{name:"password",onIonChange:t})]}),Object(T.jsxs)(U.m,{children:[Object(T.jsx)(U.n,{position:"floating",children:"WebSocket URI"}),Object(T.jsx)(U.l,{name:"wss",onIonChange:t})]}),Object(T.jsxs)(U.v,{children:[Object(T.jsx)(U.e,{className:"ion-text-center",children:Object(T.jsx)(U.c,{color:"danger",fill:"solid",children:"Cancel"})}),Object(T.jsx)(U.e,{className:"ion-text-center",children:Object(T.jsx)(U.c,{color:"primary",fill:"solid",children:"Confirm"})})]})]})})]})},me=t.p+"static/media/voip-icon-v2.bc045919.svg",fe=(t(156),function(){var e=Object(s.b)(),n=Object(s.c)((function(e){return e.ui})).msgError,t=Object(r.useState)(!1),c=Object(z.a)(t,2),a=c[0],o=c[1],i=he({username:"103@".concat(Q),password:"enzo103"}),l=Object(z.a)(i,2),j=l[0],d=l[1],u=j.username,b=j.password;return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)(U.z,{isOpen:null!==n,onDidDismiss:function(){return e(R(null))},message:n,position:"top",duration:5e3}),Object(T.jsx)(U.r,{onDidDismiss:function(){return o(!1)},isOpen:a,children:Object(T.jsx)(pe,{setShowModal:o})}),Object(T.jsxs)(U.f,{color:"primary",children:[Object(T.jsx)(U.A,{children:Object(T.jsx)(U.c,{slot:"end",fill:"clear",onClick:function(){return o(!0)},children:Object(T.jsx)(U.k,{color:"dark",icon:q.u})})}),Object(T.jsx)("div",{className:"login-subheader",children:Object(T.jsx)(U.k,{icon:me})}),Object(T.jsx)("form",{className:"ion-padding",children:Object(T.jsxs)(U.e,{children:[Object(T.jsx)(U.n,{color:"secondary",children:"Ingrese Datos de Usuario"}),Object(T.jsx)(U.m,{className:"login-item",children:Object(T.jsx)(U.l,{className:"login-input",onIonChange:d,name:"username",value:u,type:"text",placeholder:"Usuario@PBX/VoIP",required:!0,clearInput:!0})}),Object(T.jsx)(U.m,{className:"login-item",children:Object(T.jsx)(U.l,{className:"login-input",onIonChange:d,name:"password",value:b,type:"password",placeholder:"Contrase\xf1a",required:!0,clearInput:!0})}),Object(T.jsx)(U.c,{expand:"block",color:"dark",className:"ion-padding-horizontal",onClick:function(n){n.preventDefault(),e(function(e,n){return function(){var t=Object(X.a)(H.a.mark((function t(r){var c,a,o,s,i,l;return H.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r({type:O}),c=J.a.makeURI("sip:".concat(e)),a={server:"ws://voipserverenzo.ddns.net:8088/ws",connectionTimeout:600,traceSip:!0},o="",c){t.next=8;break}throw new Error("Failed to create URI");case 8:o=e.split("@")[0];case 9:s={uri:c,transportOptions:a,authorizationPassword:n,authorizationUsername:o,displayName:o,delegate:{onInvite:function(e){return r(ne(e))}}},i=new J.a(s),l=new je.a(i),i.start().then((function(){setTimeout((function(){l.register(),l.stateChange.addListener((function(e){switch(e){case de.a.Initial:break;case de.a.Registered:r(ue(o,de.a.Registered)),r(be(i));break;case de.a.Unregistered:r(R("Ingreso fallido, compruebe los datos ingresados SIP:".concat(de.a.Unregistered)));break;case de.a.Terminated:}})),r(P())}),1e3)})).catch((function(e){alert(e),r(P())}));case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(u,b))},children:"Ingresar"})]})})]})]})}),xe=(t(157),function(){var e=Object(r.useState)(!1),n=Object(z.a)(e,2),t=n[0],c=n[1],a=Object(s.c)((function(e){return e.ui})),o=a.msgError,i=a.loading,l=(a.showAlert,Object(s.c)((function(e){return e.auth})).registerState),j=Object(s.b)();return Object(r.useEffect)((function(){c(!1),"Registered"===l&&c(!0)}),[l]),Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)(U.z,{isOpen:null!==o,onDidDismiss:function(){return j(R(null))},message:o,position:"top",duration:2e3}),Object(T.jsx)(U.q,{isOpen:i,message:"Espere..."}),Object(T.jsx)(D.a,{children:Object(T.jsxs)(A.d,{children:[Object(T.jsx)(M,{exact:!0,path:"/",isLogged:t,component:le}),Object(T.jsx)(L,{path:"/auth/login",isLogged:t,component:fe}),Object(T.jsx)(A.a,{to:"/"})]})})]})}),ge=function(){return Object(T.jsxs)(U.b,{children:[Object(T.jsx)(U.s,{}),Object(T.jsx)(xe,{})]})};o.a.render(Object(T.jsx)(c.a.StrictMode,{children:Object(T.jsx)(s.a,{store:_,children:Object(T.jsx)(ge,{})})}),document.getElementById("root"))}},[[158,3,4]]]);
//# sourceMappingURL=main.80bcf475.chunk.js.map