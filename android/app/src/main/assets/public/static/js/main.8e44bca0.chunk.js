(this["webpackJsonpVoip-react"]=this["webpackJsonpVoip-react"]||[]).push([[1],{125:function(e,n,t){var r={"./ion-action-sheet.entry.js":[148,5],"./ion-alert.entry.js":[149,6],"./ion-app_8.entry.js":[150,7],"./ion-avatar_3.entry.js":[151,17],"./ion-back-button.entry.js":[152,18],"./ion-backdrop.entry.js":[153,43],"./ion-button_2.entry.js":[154,19],"./ion-card_5.entry.js":[155,20],"./ion-checkbox.entry.js":[156,21],"./ion-chip.entry.js":[157,22],"./ion-col_3.entry.js":[158,44],"./ion-datetime_3.entry.js":[159,10],"./ion-fab_3.entry.js":[160,23],"./ion-img.entry.js":[161,45],"./ion-infinite-scroll_2.entry.js":[162,46],"./ion-input.entry.js":[163,24],"./ion-item-option_3.entry.js":[164,25],"./ion-item_8.entry.js":[165,26],"./ion-loading.entry.js":[166,27],"./ion-menu_3.entry.js":[167,28],"./ion-modal.entry.js":[168,8],"./ion-nav_2.entry.js":[169,14],"./ion-popover.entry.js":[170,9],"./ion-progress-bar.entry.js":[171,29],"./ion-radio_2.entry.js":[172,30],"./ion-range.entry.js":[173,31],"./ion-refresher_2.entry.js":[174,11],"./ion-reorder_2.entry.js":[175,16],"./ion-ripple-effect.entry.js":[176,47],"./ion-route_4.entry.js":[177,32],"./ion-searchbar.entry.js":[178,33],"./ion-segment_2.entry.js":[179,34],"./ion-select_3.entry.js":[180,35],"./ion-slide_2.entry.js":[181,48],"./ion-spinner.entry.js":[182,13],"./ion-split-pane.entry.js":[183,49],"./ion-tab-bar_2.entry.js":[184,36],"./ion-tab_2.entry.js":[185,15],"./ion-text.entry.js":[186,37],"./ion-textarea.entry.js":[187,38],"./ion-toast.entry.js":[188,39],"./ion-toggle.entry.js":[189,12],"./ion-virtual-scroll.entry.js":[190,50]};function c(e){if(!t.o(r,e))return Promise.resolve().then((function(){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}));var n=r[e],c=n[0];return t.e(n[1]).then((function(){return t(c)}))}c.keys=function(){return Object.keys(r)},c.id=125,e.exports=c},127:function(e,n,t){var r={"./ion-icon.entry.js":[191,57]};function c(e){if(!t.o(r,e))return Promise.resolve().then((function(){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}));var n=r[e],c=n[0];return t.e(n[1]).then((function(){return t(c)}))}c.keys=function(){return Object.keys(r)},c.id=127,e.exports=c},138:function(e,n,t){},143:function(e,n,t){},144:function(e,n,t){},145:function(e,n,t){},146:function(e,n,t){"use strict";t.r(n);var r=t(0),c=t.n(r),o=t(45),s=t.n(o),a=t(29),i=t(62),l=t(95),j=t(14),u="[Auth] Login",d="[UI] Set Error",b="[UI] Remove Error",O="[UI] Start Loading",h="[UI] Finish Loading",p="[UI] Start Call Alert",m="[UI] Finish Call Alert",f="[SIP] Receive UA",x="[SIP] Start Calling",g="[SIP] Set Extension To Call",y="[SIP] Incoming Call",v="[SIP] Start Communication",k="[SIP] Clear Incoming Session",S={registerState:null,user:null},w={userAgent:{},extensionToCall:null,sessionState:null,incomingSession:null,startCall:""},I={loading:!1,msgError:null,showAlert:!1},C=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||i.c,N=Object(i.b)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case u:return Object(j.a)(Object(j.a)({},e),{},{user:n.payload.user,registerState:n.payload.registerState});default:return e}},ui:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case d:return Object(j.a)(Object(j.a)({},e),{},{msgError:n.payload});case b:return Object(j.a)(Object(j.a)({},e),{},{msgError:null});case O:return Object(j.a)(Object(j.a)({},e),{},{loading:!0});case h:return Object(j.a)(Object(j.a)({},e),{},{loading:!1});case p:return Object(j.a)(Object(j.a)({},e),{},{showAlert:!0});case m:return Object(j.a)(Object(j.a)({},e),{},{showAlert:!1});default:return e}},sip:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case f:return Object(j.a)(Object(j.a)({},e),{},{userAgent:n.payload});case x:return Object(j.a)(Object(j.a)({},e),{},{sessionState:n.payload});case g:return Object(j.a)(Object(j.a)({},e),{},{extensionToCall:n.payload});case v:return Object(j.a)(Object(j.a)({},e),{},{startCall:n.payload});case y:return Object(j.a)(Object(j.a)({},e),{},{incomingSession:n.payload});case k:return Object(j.a)(Object(j.a)({},e),{},{incomingSession:null});default:return e}}}),E=Object(i.d)(N,C(Object(i.a)(l.a))),_=t(4),U=(t(128),t(129),t(130),t(131),t(132),t(133),t(134),t(135),t(136),t(137),t(138),t(24)),D=t(96),z=t(26),P=function(e){return{type:d,payload:e}},A=t(75),L=t(2),R=function(e){var n=e.isLogged,t=e.component,r=Object(A.a)(e,["isLogged","component"]);return Object(L.jsx)(z.b,Object(j.a)(Object(j.a)({},r),{},{component:function(e){return n?Object(L.jsx)(z.a,{to:"/"}):Object(L.jsx)(t,Object(j.a)({},e))}}))},F=function(e){var n=e.isLogged,t=e.component,r=Object(A.a)(e,["isLogged","component"]);return Object(L.jsx)(z.b,Object(j.a)(Object(j.a)({},r),{},{component:function(e){return n?Object(L.jsx)(t,Object(j.a)({},e)):Object(L.jsx)(z.a,{to:"/auth/login"})}}))},T=t(17),q=t(10),M=t.n(q),V=t(20),B=t(199),H=t(97),X=t(7),J=t(80),G=function(e,n){n.autoplay=!0,n.srcObject=e;var t=n.play();void 0!==t&&t.then((function(){console.error("Good!")})).catch((function(e){console.error("Failed to play media"),console.error(e)})),e.onaddtrack=function(){n.load(),n.play().catch((function(e){console.error("Failed to play remote media on add track"),console.error(e)}))},e.onremovetrack=function(){n.load(),n.play().catch((function(e){console.error("Failed to play remote media on remove track"),console.error(e)}))}},W="192.168.1.10:8088",K=document.querySelector("#remoteAudio"),Q=document.querySelector("#localAudio"),Y=function(e){return{type:g,payload:e}},Z=function(){return{type:k}},$=function(e){return{type:y,payload:e}},ee=function(e,n,t){return function(r){e.stateChange.addListener((function(c){switch(console.error(c),c){case X.a.Initial:break;case X.a.Establishing:console.error("SessionState is",c),r(ne(X.a.Establishing));break;case X.a.Established:r(ne(X.a.Established));var o=e.sessionDescriptionHandler;if(!o||!(o instanceof J.a.SessionDescriptionHandler))throw new Error("Invalid session description handler.");return n&&G(o.localMediaStream,n),t&&G(o.remoteMediaStream,t),X.a.Established;case X.a.Terminating:break;case X.a.Terminated:r(ne(X.a.Terminated));break;default:throw new Error("Unknown session state.")}}))}},ne=function(e){return{type:x,payload:e}},te=function(e){var n=e.setInputValue,t=e.handleCall,r=[[1,2,3],[4,5,6],[7,8,9]];return Object(L.jsx)(_.m,{"size-md":"3",children:Object(L.jsxs)(_.i,{children:[Object(L.jsx)(_.y,{className:"ion-justify-content-center",children:r[0].map((function(e){return Object(L.jsx)(_.c,{onClick:function(){return n((function(n){return n+e.toString()}))},className:"keypad-button",children:e},e)}))}),Object(L.jsx)(_.y,{className:"ion-justify-content-center",children:r[1].map((function(e){return Object(L.jsx)(_.c,{onClick:function(){return n((function(n){return n+e.toString()}))},className:"keypad-button",children:e},e)}))}),Object(L.jsx)(_.y,{className:"ion-justify-content-center",children:r[2].map((function(e){return Object(L.jsx)(_.c,{onClick:function(){return n((function(n){return n+e.toString()}))},className:"keypad-button",children:e},e)}))}),Object(L.jsxs)(_.y,{className:"ion-justify-content-center keypad-row",children:[Object(L.jsx)(_.c,{color:"success",className:"keypad-button",onClick:t,children:Object(L.jsx)(_.o,{color:"dark",icon:T.c})}),Object(L.jsx)(_.c,{onClick:function(){return n((function(e){return e+"0"}))},className:"keypad-button",children:"0"}),Object(L.jsx)(_.c,{className:"keypad-button",children:Object(L.jsx)(_.o,{icon:T.l})})]})]})})},re=function(e){var n,t=e.incomingSession,r=Object(a.b)(),c=Object(a.c)((function(e){return e.sip})),o=c.sessionState,s=c.extensionToCall;return Object(L.jsxs)(_.j,{fullscreen:!0,children:[Object(L.jsx)(_.B,{className:"modal-call-header-title",size:"large",children:s||(null===t||void 0===t||null===(n=t.assertedIdentity)||void 0===n?void 0:n.displayName)}),Object(L.jsxs)("div",{className:"modal-call-title",children:[Object(L.jsx)(_.A,{children:"Establishing"===o?"Calling":"Established"}),"Establishing"===o&&Object(L.jsx)(_.z,{className:"modal-call-tittle-spinner",name:"dots"})]}),Object(L.jsxs)(_.m,{children:[Object(L.jsxs)(_.y,{className:"modal-row",children:[Object(L.jsx)(_.i,{children:Object(L.jsx)(_.k,{horizontal:"center",children:Object(L.jsx)(_.l,{className:"modal-fab-button",children:Object(L.jsx)(_.o,{size:"large",icon:T.u})})})}),Object(L.jsx)(_.i,{children:Object(L.jsx)(_.k,{horizontal:"center",children:Object(L.jsx)(_.l,{className:"modal-fab-button",children:Object(L.jsx)(_.o,{size:"large",icon:T.o})})})}),Object(L.jsx)(_.i,{children:Object(L.jsx)(_.k,{horizontal:"center",children:Object(L.jsx)(_.l,{className:"modal-fab-button",children:Object(L.jsx)(_.o,{size:"large",icon:T.k})})})})]}),Object(L.jsx)(_.y,{className:"modal-row",children:Object(L.jsx)(_.i,{children:Object(L.jsx)(_.k,{horizontal:"center",color:"danger",children:Object(L.jsx)(_.l,{onClick:function(){return r((e=t,function(n){e.bye(),n(Z())}));var e},className:"modal-fab-button",color:"danger",children:Object(L.jsx)(_.o,{className:"icon-transform",icon:T.c})})})})})]})]})},ce=(t(143),function(){var e,n=Object(r.useState)(""),t=Object(U.a)(n,2),c=t[0],o=t[1],s=Object(a.c)((function(e){return e.ui})),i=(s.msgError,s.showAlert,Object(a.c)((function(e){return e.sip}))),l=i.incomingSession,j=i.sessionState,u=Object(a.b)(),d={text:"Reject Call",role:"reject",handler:function(){return u((e=l,function(n){e.reject(),n(Z())}));var e}},b={text:"Accept",handler:function(){return u((e=l,function(n,t){n(ee(e,Q,K));var r=e;r.delegate={onRefer:function(e){}};var c={sessionDescriptionHandlerOptions:{constraints:{audio:!0,video:!1}}};r.accept(c)}));var e}};return Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(_.a,{isOpen:null!==l,header:"Incoming Call",subHeader:l&&"From internal ".concat(null===(e=l.assertedIdentity)||void 0===e?void 0:e.displayName),cssClass:"my-custom-class ",buttons:[d,b]}),Object(L.jsx)(_.u,{isOpen:"Establishing"===j||"Established"===j,children:Object(L.jsx)(re,{incomingSession:l})}),Object(L.jsxs)(_.w,{children:[Object(L.jsx)(_.n,{children:Object(L.jsx)(_.D,{children:Object(L.jsxs)("div",{className:"header-container",children:[Object(L.jsx)(_.B,{children:"Status: Online"}),Object(L.jsx)(_.o,{size:"small",color:"success",icon:T.j})]})})}),Object(L.jsx)(_.j,{className:"ion-justify-content-center",color:"primary",children:Object(L.jsx)(_.e,{className:"md ion-margin-horizontal",children:Object(L.jsxs)(_.f,{children:[Object(L.jsx)(_.g,{children:Object(L.jsx)(_.c,{fill:"clear",children:Object(L.jsx)(_.o,{color:"dark",icon:T.t})})}),Object(L.jsx)(_.q,{color:"light",children:Object(L.jsx)(_.p,{className:"input-keypad",value:c,onIonChange:function(e){e.preventDefault(),o(e.target.value)},type:"number",color:"dark",placeholder:"Ingrese numero de telefono",clearInput:!0})}),Object(L.jsx)(_.m,{"size-md":"6",children:Object(L.jsx)("div",{className:"keypad-container",children:Object(L.jsx)(te,{setInputValue:o,handleCall:function(){var e;u(c?(e=c,function(){var n=Object(V.a)(M.a.mark((function n(t,r){var c,o,s,a,i;return M.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t(Y(e)),c=r().sip.userAgent,o=r().auth.user,s=B.a.makeURI("sip:".concat(e,"@").concat(W))){n.next=6;break}throw new Error("Failed to create target URI.");case 6:a=new H.a(c,s),t(ee(a,Q,K)),i=a,"".concat(o,"@").concat(W),"sip:".concat(o,"@").concat(W),i.delegate={onRefer:function(e){}},a.invite().then((function(){})).catch((function(e){}));case 12:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()):P("Please enter a number to call"))}})})})]})})})]})]})}),oe=t(198),se=t(18),ae=function(e,n){return{type:u,payload:{user:e,registerState:n}}},ie=function(e){return{type:f,payload:e}},le=function(e){var n=e.setShowModal,t=function(e){var n=e.target;n.name,n.value};return Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(_.n,{translucent:!0,children:Object(L.jsxs)(_.D,{children:[Object(L.jsx)(_.d,{slot:"start",children:Object(L.jsx)(_.c,{onClick:function(){return n(!1)},children:Object(L.jsx)(_.o,{icon:T.a})})}),Object(L.jsx)(_.B,{children:"SIP Settings"})]})}),Object(L.jsx)(_.j,{children:Object(L.jsxs)(_.s,{children:[Object(L.jsxs)(_.q,{children:[Object(L.jsx)(_.r,{position:"floating",children:"SIP URI"}),Object(L.jsx)(_.p,{name:"uri",onIonChange:t})]}),Object(L.jsxs)(_.q,{children:[Object(L.jsx)(_.r,{position:"floating",children:"SIP password"}),Object(L.jsx)(_.p,{name:"password",onIonChange:t})]}),Object(L.jsxs)(_.q,{children:[Object(L.jsx)(_.r,{position:"floating",children:"WebSocket URI"}),Object(L.jsx)(_.p,{name:"wss",onIonChange:t})]}),Object(L.jsxs)(_.y,{children:[Object(L.jsx)(_.i,{className:"ion-text-center",children:Object(L.jsx)(_.c,{color:"danger",fill:"solid",children:"Cancel"})}),Object(L.jsx)(_.i,{className:"ion-text-center",children:Object(L.jsx)(_.c,{color:"primary",fill:"solid",children:"Confirm"})})]})]})})]})},je=(t(144),t(25)),ue=function(e){var n=Object(r.useState)(e),t=Object(U.a)(n,2),c=t[0],o=t[1];return[c,function(e){var n=e.target;o(Object(j.a)(Object(j.a)({},c),{},Object(je.a)({},n.name,n.value)))},function(){o(e)}]},de=function(){var e=Object(a.b)(),n=Object(a.c)((function(e){return e.ui})).msgError,t=Object(r.useState)(!1),c=Object(U.a)(t,2),o=c[0],s=c[1],i=ue({username:"103@192.168.1.10:8088",password:"enzo103"}),l=Object(U.a)(i,2),j=l[0],u=l[1],d=j.username,b=j.password;return Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(_.C,{isOpen:null!==n,onDidDismiss:function(){return e(P(null))},message:n,position:"top",duration:5e3}),Object(L.jsx)(_.u,{onDidDismiss:function(){return s(!1)},isOpen:o,children:Object(L.jsx)(le,{setShowModal:s})}),Object(L.jsx)(_.j,{color:"primary",children:Object(L.jsx)(_.e,{className:"md ion-margin-horizontal",children:Object(L.jsxs)(_.f,{children:[Object(L.jsxs)(_.g,{children:[Object(L.jsx)(_.h,{children:"Login"}),Object(L.jsx)(_.c,{fill:"clear",onClick:function(){return s(!0)},children:Object(L.jsx)(_.o,{color:"dark",icon:T.t})})]}),Object(L.jsx)(_.m,{"size-md":"6",children:Object(L.jsx)(_.y,{children:Object(L.jsxs)(_.i,{children:[Object(L.jsx)(_.r,{color:"primary",children:"Ingrese Datos de Usuario"}),Object(L.jsx)(_.q,{color:"light",children:Object(L.jsx)(_.p,{onIonChange:u,name:"username",value:d,type:"text",placeholder:"Usuario@PBX/VoIP",color:"dark",required:!0,clearInput:!0})}),Object(L.jsx)(_.r,{color:"primary",children:"Ingrese Contrase\xf1a"}),Object(L.jsxs)(_.q,{color:"light",children:[Object(L.jsx)(_.o,{color:"light",name:"eye-outline"}),Object(L.jsx)(_.p,{onIonChange:u,name:"password",value:b,type:"password",placeholder:"Contrase\xf1a",required:!0,clearInput:!0})]}),Object(L.jsx)(_.c,{onClick:function(n){n.preventDefault(),e(function(e,n){return function(){var t=Object(V.a)(M.a.mark((function t(r){var c,o,s,a,i,l;return M.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r({type:O}),c=B.a.makeURI("sip:".concat(e)),o={server:"ws://192.168.1.10:8088/ws",connectionTimeout:600,traceSip:!0},s="",c){t.next=8;break}throw new Error("Failed to create URI");case 8:s=e.split("@")[0];case 9:a={uri:c,transportOptions:o,authorizationPassword:n,authorizationUsername:s,displayName:s,delegate:{onInvite:function(e){return r($(e))}}},i=new B.a(a),l=new oe.a(i),i.start().then((function(){setTimeout((function(){l.register(),l.stateChange.addListener((function(e){switch(e){case se.a.Initial:break;case se.a.Registered:r(ae(s,se.a.Registered)),r(ie(i));break;case se.a.Unregistered:r(P("Ingreso fallido, compruebe los datos ingresados SIP:".concat(se.a.Unregistered)));break;case se.a.Terminated:}})),r({type:h})}),1e3)})).catch((function(e){alert(e)}));case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(d,b))},expand:"block",children:"Ingresar"})]})})})]})})})]})},be=(t(145),function(){var e=Object(r.useState)(!1),n=Object(U.a)(e,2),t=n[0],c=n[1],o=Object(a.c)((function(e){return e.ui})),s=o.msgError,i=o.loading,l=(o.showAlert,Object(a.c)((function(e){return e.auth})).registerState),j=Object(a.b)();return Object(r.useEffect)((function(){c(!1),"Registered"===l&&c(!0)}),[l]),Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(_.C,{isOpen:null!==s,onDidDismiss:function(){return j(P(null))},message:s,position:"top",duration:2e3,color:"light"}),Object(L.jsx)(_.t,{isOpen:i,message:"Espere...",duration:4e3}),Object(L.jsx)(D.a,{children:Object(L.jsxs)(z.d,{children:[Object(L.jsx)(F,{exact:!0,path:"/",isLogged:t,component:ce}),Object(L.jsx)(R,{path:"/auth/login",isLogged:t,component:de}),Object(L.jsx)(z.a,{to:"/"})]})})]})}),Oe=function(){return Object(L.jsxs)(_.b,{children:[Object(L.jsx)(_.v,{}),Object(L.jsx)(be,{})]})};s.a.render(Object(L.jsx)(c.a.StrictMode,{children:Object(L.jsx)(a.a,{store:E,children:Object(L.jsx)(Oe,{})})}),document.getElementById("root"))}},[[146,3,4]]]);
//# sourceMappingURL=main.8e44bca0.chunk.js.map